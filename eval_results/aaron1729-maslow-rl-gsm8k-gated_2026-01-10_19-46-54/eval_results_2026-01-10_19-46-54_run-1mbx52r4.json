{
  "metrics": {
    "num_samples": 100,
    "reward_total_mean": 1.2860712365978275,
    "r_a_mean": 0.986,
    "r_b_mean": 0.37,
    "gate_b_mean": 0.8087916670759497,
    "accuracy": 0.37,
    "json_parse_rate": 0.99,
    "valid_schema_rate": 0.98,
    "r_a_perfect_rate": 0.98
  },
  "samples": [
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: The number of math problems that Marvin practiced today is three times as many as the number of problems he solved yesterday. His friend, Arvin, has practiced twice as many math problems on each day. How many math problems have they practiced altogether if Marvin solved 40 math problems yesterday?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"Marvin solved 40 math problems yesterday.\",\n  \"step_2\": \"Today, Marvin practiced three times as many problems as yesterday, so he practiced 3*40 = 120 problems today.\",\n  \"step_3\": \"Together, Marvin practiced 40+120=160 problems.\",\n  \"step_4\": \"Arvin practiced twice as many problems as Marvin did yesterday, meaning he practiced 2*40 = 80 problems today.\",\n  \"step_5\": \"Altogether, Arvin practiced 80+40=120 problems.\",\n  \"answer\": 120\n}",
      "target_int": 480,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: Linda was gathering eggs from her chicken coops. When she was done, she had three times as many white eggs as brown eggs. On her way back to the house, she stumbled, dropping her egg basket. Upon inspecting the damage, she found that all 5 of the brown eggs survived, but now she only had a dozen eggs left. How many eggs did Linda break?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"Linda initially gathered 5*3=15 white eggs.\",\n  \"step_2\": \"So, she had 15+12=27 eggs left.\",\n  \"step_3\": \"Therefore, Linda broke 27-5=22 eggs.\",\n  \"answer\": 22\n}",
      "target_int": 8,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: Bobby received his weekly paycheck today.  Although his salary is $450 per week, his actual paycheck is reduced in size because there are some taxes, insurance payments, and fees removed from his pay before his employer writes the check.  If the government removes 1/3 in federal taxes and 8% in state taxes, the health insurance removes $50 per week, the life insurance removes $20 per week, and the city charges him a fee of $10 per week for parking, then what is the final amount left in Bobby's paycheck, in dollars?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"Bobby's salary is $450 per week, so the federal tax deduction is 1/3 * $450 = $150.\",\n  \"step_2\": \"The state tax deduction is 8% of $450, which is 0.08 * $450 = $36.\",\n  \"step_3\": \"So the total deductions are $150 + $36 = $186.\",\n  \"step_4\": \"Therefore, the final amount left in Bobby's paycheck is $450 - $186 = $264.\",\n  \"answer\": 264\n}",
      "target_int": 184,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: Tom fills a 250 pound sandbag 80% full.  But the filling material he is using is 40% heavier than sand.  How much does the bag weigh?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"A 250-pound sandbag is filled 80% full with sand, so it contains 250 * 0.8 = 200 pounds of sand.\",\n  \"step_2\": \"But the filling material is 40% heavier than sand, meaning it weighs 200 * 1.4 = 280 pounds more than sand.\",\n  \"step_3\": \"Therefore, the bag weighs 250 + 280 = 530 pounds.\",\n  \"answer\": 530\n}",
      "target_int": 280,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: Freddy is calling his family on New Year's Eve. He calls his dad, who lives in the same city as him, and they talk for 45 minutes. Then he calls his brother, who lives on the other side of the world, and they talk for 31 minutes. Local calls cost 5 cents a minute, while international calls cost 25 cents a minute. How many dollars did Freddy spend calling his family on New Year's Eve?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"Local call cost: $0.05/minute * 45 minutes = $2.25\",\n  \"step_2\": \"International call cost: $0.25/minute * 31 minutes = $0.75\",\n  \"step_3\": \"Total cost: $2.25 + $0.75 = $3.00\",\n  \"answer\": 3\n}",
      "target_int": 10,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: Susan has 21 cats and Bob has 3 cats. If Susan gives Robert 4 of her cats, how many more cats does Susan have than Bob?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"Susan originally has 21 cats and gives away 4, so she now has 21 - 4 = 17 cats.\",\n  \"step_2\": \"Bob originally has 3 cats and gains 4, so he now has 3 + 4 = 7 cats.\",\n  \"step_3\": \"Therefore, Susan has 17 - 7 = 10 more cats than Bob.\",\n  \"answer\": 10\n}",
      "target_int": 14,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: John plays paintball 3 times a month.  Each time he plays he buys 3 boxes of paintballs.  They cost $25 per box.  How much does he spend a month on paintballs?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"John plays paintball 3*3=9 times a month.\",\n  \"step_2\": \"So he spends 9*$25=$225 a month on paintballs.\",\n  \"answer\": 225\n}",
      "target_int": 225,
      "reward": 1.8175744761936437,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 1.0,
        "gate_b": 0.8175744761936437,
        "total": 1.8175744761936437,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: Jackie can do 5 push-ups in 10 seconds. How many push-ups can she do in one minute if she takes two 8-second breaks?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"In one second, Jackie can do 5/10 = 0.5 push-ups.\",\n  \"step_2\": \"So, in one minute, which is 60 seconds, Jackie can do 0.5*60 = 30 push-ups without breaks.\",\n  \"step_3\": \"However, Jackie has two 8-second breaks, so her total break time is 2*8 = 16 seconds.\",\n  \"step_4\": \"Therefore, Jackie can do 30-16 = 14 push-ups in one minute with breaks.\",\n  \"answer\": 14\n}",
      "target_int": 22,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: Kyle bought 2 glass bottles that can hold 15 origami stars each. He then bought another 3 identical glass bottles. How many stars must Kyle make to fill all the glass bottles he bought?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"Kyle initially bought 2 glass bottles that can hold 15 stars each, so they have a total capacity of 2*15 = 30 stars.\",\n  \"step_2\": \"He then bought another 3 identical glass bottles, which means there are now 3*2 = 6 additional bottles.\",\n  \"step_3\": \"So in total, Kyle has 30+6 = 36 stars he needs to make.\",\n  \"answer\": 36\n}",
      "target_int": 75,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: Merry had 50 boxes of apples on Saturday and 25 boxes on Sunday. There were 10 apples in each box. If she sold a total of 720 apples on Saturday and Sunday, how many boxes of apples are left?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"Merry had 50 boxes of apples on Saturday, so she had a total of 50 * 10 = 500 apples on Saturday.\",\n  \"step_2\": \"She also had 25 boxes on Sunday, so she had a total of 25 * 10 = 250 apples on Sunday.\",\n  \"step_3\": \"So, she had a total of 500 + 250 = 750 apples altogether.\",\n  \"step_4\": \"If she sold 720 apples on Saturday and Sunday combined, then she has 750 - 720 = 30 apples left.\",\n  \"answer\": 30\n}",
      "target_int": 3,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: On each of 7 Mondays, it rained 1.5 centimeters. On each of 9 Tuesdays it rained 2.5 centimeters. How many more centimeters did it rain on Tuesdays than Mondays?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"On each of 7 Mondays, it rained 1.5 cm, so 7 * 1.5 = 10.5 cm.\",\n  \"step_2\": \"On each of 9 Tuesdays, it rained 2.5 cm, so 9 * 2.5 = 22.5 cm.\",\n  \"step_3\": \"It rained 22.5 - 10.5 = 12 more centimeters on Tuesdays than on Mondays.\",\n  \"answer\": 12\n}",
      "target_int": 12,
      "reward": 1.8175744761936437,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 1.0,
        "gate_b": 0.8175744761936437,
        "total": 1.8175744761936437,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: There are 50 goldfish in the pond. Each goldfish eats 1.5 ounces of food per day. 20% of the goldfish need to eat special food that costs $3 an ounce. How much does it cost to feed these fish?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"There are 50*0.2 = 10 goldfish that need special food.\",\n  \"step_2\": \"Each special food goldfish eats consumes 1.5*0.1 = $0.15 worth of food daily.\",\n  \"step_3\": \"$0.15 is equal to $0.15/3=$0.05 per ounce, so it costs $0.05*$100=$5 to feed these fish.\",\n  \"answer\": 5\n}",
      "target_int": 45,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: In a parking lot, there are cars and motorcycles.  Each car has 5 wheels (including one spare) and each motorcycle has 2 wheels. There are 19 cars in the parking lot. Altogether all vehicles have 117 wheels. How many motorcycles are at the parking lot?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"There are 19 cars in the parking lot, so they have a total of 19 * 5 = 95 wheels.\",\n  \"step_2\": \"Altogether, there are 95 + 117 = 212 wheels accounted for.\",\n  \"step_3\": \"Therefore, there must be 212 / 2 = 106 motorcycles in the parking lot.\",\n  \"answer\": 106\n}",
      "target_int": 11,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: A liter of chlorine costs $10 and is now sold at 20% off. A box of soap that costs $16 is now sold at 25% off. How much will you save if you buy 3 liters of chlorine and 5 boxes of soap?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"A liter of chlorine costs $10 and is sold at 20%, so it costs 10 * .8 = $8 discount.\",\n  \"step_2\": \"So, a liter of chlorine costs $10 - $8 = $2 cheaper.\",\n  \"step_3\": \"Therefore, 3 liters of chlorine cost 3 * $2 = $6 cheaper.\",\n  \"step_4\": \"A box of soap originally costs $16 and is sold at 25%, so it costs 16 * .25 = $4 discount.\",\n  \"step_5\": \"So, a box of soap costs $16 - $4 = $12 cheaper.\",\n  \"step_6\": \"Therefore, 5 boxes of soap cost 5 * $12 = $60 cheaper.\",\n  \"step_7\": \"In total, you can save $6 + $60 = $66.\",\n  \"answer\": 66\n}",
      "target_int": 26,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: Half of Jerome's money was $43. He gave $8 to Meg and thrice as much to Bianca. How much does Jerome have left?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"Half of Jerome's money is $43, so his total money is $43 * 2 = $86.\",\n  \"step_2\": \"He gave $8 to Meg, so he had $86 - $8 = $78 left.\",\n  \"step_3\": \"He gave twice as much to Bianca as he did to Meg, which means he gave Bianca 2*$8 = $16.\",\n  \"step_4\": \"So, he has $78 - $16 = $62 left.\",\n  \"answer\": 62\n}",
      "target_int": 54,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: John needs to take 2 pills a day.  One pill costs $1.5.  The insurance covers 40% of the cost.  How much does he pay in a 30-day month?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"John takes 2*16=$32 worth of pills a day.\",\n  \"step_2\": \"So his monthly cost is 32*.4=$12.8.\",\n  \"step_3\": \"Therefore, he pays 12.8/30=$0.433 per day.\",\n  \"step_4\": \"So he pays 0.433*30=$13.99 in a 30-day month.\",\n  \"answer\": 13.99\n}",
      "target_int": 54,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: Henry took 9 pills a day for 14 days. Of these 9 pills, 4 pills cost $1.50 each, and the other pills each cost $5.50 more. How much did he spend in total on the pills?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"Henry took 9*14 = 126 pills over 14 days.\",\n  \"step_2\": \"The 4 pills cost him 4*$1.50 = $6.\",\n  \"step_3\": \"The other pills cost him $1.50+$5.5=$8.00 each, so they cost him 8*(14-4)= $104.\",\n  \"step_4\": \"So, Henry spent $6+$104= $110 on his pills.\",\n  \"answer\": 110\n}",
      "target_int": 41,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: In ancient China, soldiers positioned in beacon towers along the Great Wall would send smoke signals to warn of impending attacks.  Since the towers were located at 5 kilometer intervals, they could send a signal the length of the Great Wall.  If the Great wall was 7300 kilometers long, and every tower had two soldiers, what was the combined number of soldiers in beacon towers on the Great Wall?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"Since the towers were located at 5 kilometer intervals, the Great Wall was 7300/5 = 1460 towers long.\",\n  \"step_2\": \"If every tower had two soldiers, then there were 1460*2 = 2920 soldiers in beacon towers on the Great Wall.\",\n  \"answer\": 2920\n}",
      "target_int": 2920,
      "reward": 1.8175744761936437,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 1.0,
        "gate_b": 0.8175744761936437,
        "total": 1.8175744761936437,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: Micah bought envelopes to send, and depending on the weight of the envelope he will need more stamps. If an envelope weighs more than 5 pounds, he will need 5 stamps. If it weighs less than that, it will only need 2 stamps. If he bought 52 stamps with 6 envelopes that weigh less than 5 pounds, how many envelopes in total did Micah need to buy?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"Micah used 5*6 = 30 stamps for the envelopes that weighed less than 5 pounds.\",\n  \"step_2\": \"Micah used 2*6 = 12 stamps for the envelopes that weighed more than 5 pounds.\",\n  \"step_3\": \"So, Micah used 30+12= 42 stamps in total.\",\n  \"step_4\": \"Therefore, Micah needed to buy 42/20 = 2.1 envelopes.\",\n  \"answer\": 2\n}",
      "target_int": 14,
      "reward": 0.9999999999999999,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 0.0,
        "gate_b": 0.8175744761936437,
        "total": 0.9999999999999999,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    },
    {
      "prompt": [
        {
          "content": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
          "role": "system"
        },
        {
          "content": "Problem: Mr. Caiden wants to do repairs to his house and requires 300 feet of metal roofing to do this. If each foot of roofing costs $8, and the supplier of the metal roofing brings in 250 feet of metal roofing for free, how much money is Mr. Caiden required to pay for the remaining metal roofing?",
          "role": "user"
        }
      ],
      "completion": "{\n  \"step_1\": \"Mr. Caiden needs 300 feet of metal roofing, but the supplier brought in 250 feet, so he has 300 - 250 = 50 feet of metal roofing left.\",\n  \"step_2\": \"Since each foot of roofing costs $8, Mr. Caiden needs to pay 50 * $8 = $400 for the remaining metal roofing.\",\n  \"answer\": 400\n}",
      "target_int": 400,
      "reward": 1.8175744761936437,
      "info": {
        "r_a": 0.9999999999999999,
        "r_b": 1.0,
        "gate_b": 0.8175744761936437,
        "total": 1.8175744761936437,
        "tier_a_components": {
          "parsable_json": 0.3,
          "valid_schema": 0.4,
          "numeric_answer": 0.2,
          "json_only": 0.1
        }
      }
    }
  ],
  "config": {
    "experiment": {
      "name": "gsm8k-grpo-gated",
      "run_type": "gated",
      "seed": 42,
      "output_dir": "./outputs",
      "wandb_enabled": true,
      "wandb_project": "maslow-rl"
    },
    "model": {
      "name": "Qwen/Qwen2-0.5B-Instruct",
      "dtype": "bf16",
      "device_map": "auto"
    },
    "lora": {
      "r": 16,
      "lora_alpha": 32,
      "lora_dropout": 0.05,
      "target_modules": [
        "q_proj",
        "k_proj",
        "v_proj",
        "o_proj"
      ],
      "bias": "none",
      "task_type": "CAUSAL_LM"
    },
    "data": {
      "dataset_name": "openai/gsm8k",
      "dataset_config": "main",
      "train_size": 500,
      "eval_size": 100,
      "sample_seed": 42
    },
    "training": {
      "num_train_steps": 1000,
      "per_device_train_batch_size": 8,
      "per_device_eval_batch_size": 8,
      "learning_rate": 0.0001,
      "warmup_steps": 50,
      "logging_steps": 10,
      "eval_steps": 100,
      "save_steps": 250,
      "gradient_accumulation_steps": 1
    },
    "grpo": {
      "num_generations_per_prompt": 8,
      "max_new_tokens": 256,
      "temperature": 1.0,
      "top_p": 0.9,
      "kl_coef": 0.01
    },
    "rewards": {
      "tier_a_weights": {
        "parsable_json": 0.3,
        "valid_schema": 0.4,
        "numeric_answer": 0.2,
        "json_only": 0.1
      },
      "gating": {
        "k": 3,
        "tau": 0.5,
        "beta": 1.0
      },
      "tier_c": {
        "enabled": false,
        "gamma": 0.1,
        "judge_fraction": 0.25,
        "judge_model": "gpt-4"
      }
    },
    "prompt": {
      "system_message": "You must output a JSON object and nothing else. Use keys step_1, step_2, etc. for your reasoning steps, and answer for the final numeric answer.\n\nIMPORTANT: You will be penalized if you do not include at least 2 valid steps. Each step must contain either:\n(1) A reformulation of the word problem into mathematical terms, OR\n(2) A single algebraic manipulation (e.g., \"Subtract 4 from both sides to get x = 7\")\n\nThe validity and quality of your steps matter. Make each step meaningful.\n\nExample:\n{\n  \"step_1\": \"Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes 4 into muffins.\",\n  \"step_2\": \"Eggs remaining: 16 - 3 - 4 = 9 eggs per day\",\n  \"answer\": 9\n}\n\nDo not include any text before or after the JSON.",
      "user_template": "Problem: {question}"
    },
    "eval": {
      "temperature": 0.1,
      "num_samples_to_save": 20,
      "eval_at_steps": [
        0,
        250,
        500,
        750,
        1000
      ]
    }
  }
}